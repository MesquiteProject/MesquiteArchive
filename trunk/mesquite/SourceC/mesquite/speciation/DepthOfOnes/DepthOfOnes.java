package mesquite.speciation.DepthOfOnes;/*~~  */import java.applet.*;import java.util.*;import java.awt.*;import mesquite.lib.*;import mesquite.lib.duties.*;import mesquite.lib.characters.*;import mesquite.categ.lib.*;/* ======================================================================== */public class DepthOfOnes extends NumForCharHistAndTree {	/*.................................................................................................................*/	public boolean startJob(String arguments, Object condition, CommandRecord commandRec, boolean hiredByName) { 		return true;  	 }  	   	 int sum = 0;  	 int count = 0;	/*.................................................................................................................*/	public   void findOnesPass(int node, Tree tree, CategoricalHistory statesAtNodes) {		long s = statesAtNodes.getState(node);		if (CategoricalState.isElement(s, 1)){			sum += tree.mostStepsAboveNode(node);			count++;		}		else for (int d = tree.firstDaughterOfNode(node); tree.nodeExists(d); d = tree.nextSisterOfNode(d)) 			findOnesPass(d, tree, statesAtNodes);	}	/*.................................................................................................................*/	public  void calculateNumber(Tree tree, CharacterHistory charHistory, MesquiteNumber result, MesquiteString resultString, CommandRecord commandRec){		if (result == null || tree == null  || charHistory == null || !(charHistory instanceof CategoricalHistory))			return;		result.setToUnassigned();	  	sum = 0;	  	count = 0;	  	findOnesPass(tree.getRoot(), tree, (CategoricalHistory)charHistory);	  	if (count > 0)			result.setValue(sum*1.0/count);		else			result.setValue(0);		if (resultString!=null)			resultString.setValue("Depth of 1's: " + result.toString());	}	/*.................................................................................................................*/    	 public String getName() {		return "Depth of Ones";   	 }	/*.................................................................................................................*/  	 public String getExplanation() {		return "Returns the average depth of 1's in the history.";   	 }	/*.................................................................................................................*/	/** Returns CompatibilityTest so other modules know if this is compatible with some object. */	public CompatibilityTest getCompatibilityTest(){		return new CategoricalStateTest();	}}