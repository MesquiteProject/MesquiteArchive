<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN"><html><!-- #BeginTemplate "/Templates/Template.dwt" --><!-- DW6 --><head><!--LINK REL="SHORTCUT ICON" HREF="images/mesq.ico"--><!-- #BeginEditable "doctitle" -->
<title>Slatkin &amp; Maddison's s</title>
<!-- #EndEditable --><meta http-equiv="Content-Type" content="text/html; charset=iso-8859-1"></head><body bgcolor="#FFFFFF"><div id="Page" style="position:absolute; left:0px; top:0px; z-index:1; visibility: visible; width: 100%; height: 100%">   <table border="0" cellspacing="0" cellpadding="0" width="100%">    <tr> 	  <td align="left" valign="top" height="60">         <table border="0" cellspacing="0" cellpadding="0" height="60" width="300">          <tr>        		<td width="10" height="60" align="left" valign="top"> <font face="Trebuchet MS"><img src="../images/pixel.gif" width="1" height="1" alt=" " border="0"></font></td>            <td bgcolor="#FFFFFF">               <div align="left"><font face="Trebuchet MS"><a href="../manual.html"><img src="../images/mesquitesmall.gif" width="268" height="92" border="0" alt="Mesquite"></a></font></div>            </td>          </tr>		  <tr>			<td height="42" align="left" valign="top"></td>			<td height="42" align="left" valign="top"><font face="Trebuchet MS"><a href="../manual.html"><img src="../images/mesquiteLowerManual.gif" border="0"></a></font></td>		  </tr><!--	  <tr>  		    <td colspan="2" height="10"></td>		  </tr>	      <tr>		    <td colspan="2" height="15" align="center" valign="middle">			<!-- Google CSE Search Box Begins				<form id="searchbox_016202157087875381635:khljhzi-ps8" action="http://www.google.com/cse">					<input type="hidden" name="cx" value="016202157087875381635:khljhzi-ps8" />					<input type="hidden" name="cof" value="FORID:0" />					<input name="q" type="text" size="20" />					<input type="submit" name="sa" value="Search Mesquite" />				<!--<img src="http://www.google.com/coop/images/google_custom_search_smnar.gif" alt="Google Custom Search" />		  		</form>			<!-- Google CSE Search Box Ends        		    </td>		  </tr> -->        </table>      </td>	<td>        <table border="0" cellspacing="0" cellpadding="0" height="134" width="550">          <tr valign="top" height="92">            	<td width="72" align="center"  height="92" valign="top" bgcolor="#FFFFFF"><font face="Trebuchet MS"><img src="../images/fadeRight.gif" width="72" height="160"></font></td>			<td bgcolor="#99FF99"><img src="../images/introduction.gif" valign="bottom"></td>			<td align="left" valign="top" height="92" width = "160" bgcolor="#99FF99">                 <p><font face="Trebuchet MS"><span class="smallplain"><a href="../manual.html">                  Introduction</a><br>                  </span><a href="../whyMesquite.html">Why?</a><br>                  <a href="../publication.html#howToCite">How to Cite</a>                <br>                  <a href="../publication.html">Publication</a><br>                  <a href="../support.html">Support</a><br>                  <a href="../credits.html">Credits</a> </font><br>                  <font face="Trebuchet MS"><span class="smallplain"><a href="../help.html">Help</a></span></font><br>                  <a href="MesquiteFAQ.html"><font face="Trebuchet MS">FAQ</font></a><br>                   <a href="http://mesquiteproject.org"><font face="Trebuchet MS">Web Site</font></a><br>			</td>      		<td bgcolor="#99FF99"><img src="../images/basics.gif" valign="bottom"></td>			<td align="left" valign="top" height="92" width="220"  bgcolor="#99FF99">               <p><font face="Trebuchet MS"><span class="smallplain"><a href="../help.html"></a>                <a href="../managingFiles.html">Files</a></span> <br>                <span class="smallplain"><a href="../menus.html">Menus</a><br>                <a href="../windows.html">Windows</a><br>				<a href="../charts.html">Charts</a><br>                <a href="../scripting.html">Scripts/Macros</a> <br>                <a href="../modules.html">Modules</a><br>				<a href="../howMesquiteWorks.html">How</a></span></font>              </td>      		<td bgcolor="#99FF99"><img src="../images/objects.gif" valign="bottom"></td>			<td align="left" valign="top" height="92" width="260"  bgcolor="#99FF99">				<p><font face="Trebuchet MS">                <span class="smallplain"><a href="../characters.html">Characters</a></span></font><font face="Trebuchet MS"><span class="smallplain"><a href="../Taxa.html"><br>                Taxa<br>                </a></span></font><font face="Trebuchet MS"><a href="../trees.html">Trees</a><br>                <a href="../glossary.html">Glossary</a> </font></p>              <p><font face="Trebuchet MS"><em><font face="Trebuchet MS"><a href="../changes.html">New</a><br>                &nbsp;&nbsp;<a href="../changes.html">Features</a></font></em></font></p>              </td>      		<td align="left" valign="top" height="92" width="92"><font face="Trebuchet MS"><img src="../images/fadeLeft.gif" width="92" height="160"></font></td>		</tr>    	<tr>		    <td width="72" height="20"></td>		<td></td>		    <td>&nbsp;</td>            <td>&nbsp;</td>            <td>&nbsp;</td>		</tr>		</table>		</td>	</tr>  </table>  <table border="0" cellspacing="0" cellpadding="0" width="100%" height="100%">    <tr>       <td valign="top" align="left" width="110" height="100%">         <table border="0" cellspacing="0" cellpadding="0" width="142">          <tr> 			<td colspan="3" bgcolor="#99FF99"><p><font face="Trebuchet MS"><img src="../images/fadeDown.gif" width="100%" height="95" valign "top" border="0" alt=" "></font></p></td>		  </tr>          <tr>             <td width="6" bgcolor="#99FF99" height="35"></td>			<td colspan="2" bgcolor="99FF99" valign="top" height="35"><p><font face="Trebuchet MS"><a href="../toc.html">Table of</a><br> 			   &nbsp; &nbsp; <a href="../toc.html">Contents</a></font></p></td>		  </tr>		  <tr>            <td width="6" bgcolor="#99FF99" height="35"></td>            <td colspan="2" bgcolor="#99FF99" height="35"><p><font face="Trebuchet MS"><img src="../images/analyses.gif"></font></p>              </td>          </tr>          <tr bgcolor="#99FF99">             <td height="35" align="left" valign="middle" bgcolor="#99FF99">&nbsp;</td>            <td width="131" height="35" align="left" valign="middle"><p>			  <font face="Trebuchet MS">			  <a href="../CharacterEvolution/charEvolution.html">Character</a><br>			    &nbsp; <a href="../CharacterEvolution/charEvolution.html">Evolution</a> <br> <br>			  <a href="../Diversification/diversification.html">Diversification</a><br><br>			  <a href="../molecular/molecular.html">Molecular</a><br>			    &nbsp; <a href="../molecular/molecular.html">Data</a><br><br>			  <a href="../popGen/popGen.html">Gene trees</a> <br>  <br>			  <a href="../RandomSimul/RandomSimul.html">Simulations &amp;</a><br>			    &nbsp; <a href="../RandomSimul/RandomSimul.html">Randomizations</a> <br> <br>			  <a href="../continuous/continuous.html">Continuous</a><br>			    &nbsp; <a href="../continuous/continuous.html">Characters</a><br> <br>			  <a href="../otherPrograms.html">Use with</a><br>			    &nbsp; <a href="../otherPrograms.html">Other Programs</a> <br><br>			  <a href="../studies/index.html">Studies</a> </font></p></td>            <td width="5" height="35" align="left" valign="middle">&nbsp;</td>          </tr>          <tr bgcolor="#99FF99">             <td height="35" align="left" valign="middle">&nbsp;</td>            <td height="35" align="left" valign="middle">&nbsp;</td>            <td height="35" align="left" valign="middle">&nbsp;</td>          </tr>          <tr>             <td height="35" align="left" valign="middle"><font face="Trebuchet MS"><img src="../images/fadeUp.gif" width="5" height="92"></font></td>            <td height="35" align="left" valign="middle" colspan="2"><font face="Trebuchet MS"><img src="../images/fadeUp.gif" width="100%" height="92"></font></td>          </tr>        </table>      </td>      <td valign="top" width="100%" height="100%">         <table width="700" border="0" cellpadding="10" cellspacing="0">          <tr>             <td><font face="Trebuchet MS"><!-- #BeginEditable "body" -->
			<h2>Analyzing population structure using Slatkin &amp; Maddison's s</h2>
			<h4>Background</h4>
				<p>This is a parametric bootstrapping approach, where an explicit model is 
				used to generate a distribution of expected values of a test statistic.  If the observed value of this 
				test statistic falls outside of the 95% confidence interval of the simulated distribution, the model is
				rejected.  In this case, the test statistic, <i>s</i>, is counting the number of changes 
				(in parsimony steps) of a character corresponding to population membership 
				(Slatkin &amp; Maddison 1989).  In the instructions below, we deal with two types
				of taxa: genes and populations.  Genes are the gene sequences used to generate a gene tree; each gene 
				sequence usually corresponds to a single sampled individual.  Populations are those groupings, determined 
				by the user, for hierarchically organizing individual gene sequences into groupings based on geography, 
				morphology, or other information.
				</p>
			<h4>Instructions &amp; Example</h4>
			<p>These instructions are provided with a worked example.  Because each model being tested is likely
			specific to the question being asked, many parameter values and models of population structure will
			be unique to each study.  The models and parameter values used in this example are for educational 
			purposes only, and we encourage investigators to allow reasonable consideration of model paremeters.</p>

			<p><strong>Getting Started</strong> &#8212; You will need a Mesquite file with the following parts:</p>
			<ul>
				<li>Taxa Block corresponding to genes sampled</li>
				<li>Reconstructed gene tree</li>
				<li>One or more Taxa Blocks corresponding to populations &#8212; You may have multiple population 
				taxa blocks corresponding to different models of population structure.  For the ease of this example,
				we will only deal with a single population taxa block.</li>
				<li><a href="../popGen/popGen.html#establishing" title "Establishing Associations">Association</a> 
				between the gene taxa and population taxa</li>
				<li>Population Tree Block corresponding to model(s) being tested &#8212; Instructions for creating these 
				model trees are provided below.</li>
			</ul>
			<p><strong>Calculating observed value of <i>s</i></strong>
				The easiest way to do this is to add a Tree Legend to the gene tree.  If you do not have a tree window
				open showing the reconstructed gene tree, open one using <u><font size="-1">Taxa&amp;Trees &gt; New Tree 
				Window</font></u>.  Add the legend from the Analysis menu (<u><font size="-1">Analysis &gt; Tree 
				Legend...</font></u>), and select &quot;s of Slatkin &amp; Maddison&quot;.  If you have more than one
				association included in the file, you will be asked to choose which association to use for the calculations.
				Record the number that appears in the tree legend &#8212 this is the observed value of the test statistic.
			</p>
			<table width="100%" border="0" cellspacing="0" cellpadding="5">
			<tr>
			<td bgcolor="#99FF99">
			<p>In our example, we have 20 gene sequences, sampled from 4 populations.  The color of the gene sequences 
			corresponds to the population from which they were sampled (note: taxon name colors are only used for aesthetics
			and are not required for this type of analysis.  If you would like to color taxon names, you will 
			need to set up &quot;<a href="QualityTrees.html#taxonNameColors" title="Setting up groups">Groups</a>&quot; 
			of taxa, which are not the same as associations.).  In this example, <i>s</i> is counting the number of changes 
			(in parsimony steps) of a character corresponding to population membership (as indicated by color):</p>

			<center><img src="images/observedStatistic.jpg"></center><br>
			<p>Counting the most parsimonious number of changes leads to <i>s</i> = 9</p>
			</td>
			</tr>
			</table>
			<p><strong>Setting up models to be tested</strong>
				Begin by opening a new tree window, corresponding to the population block of taxa.  Select 
				<u><font size="-1">Default Trees</font></u> as the source of trees.  Manipulate this tree to reflect the 
				model you wish to test.  In order to preserve any changes you make to the tree, you must store the tree in a 
				Tree Block (<u><font size="-1">Tree &gt; Store Tree As...</font></u>).
			</p>

			<table width="100%" border="0" cellspacing="0" cellpadding="5">
			<tr>
			<td bgcolor="#99FF99">
			<p>In our example, we would like to test two models; the first is a model of population fragmentation, in 
			which all four populations became isolated from one another, some time in the past, say 100,000 
			generations ago.  Starting with a default symmetrical tree, we use the collapse branch tool 
			(<img src="../images/treeTools/collapseBranch.gif">) to collapse the branches indicated 
			in red on the tree to the left, to create the tree on the right.</p>
				<table width="100%" border="0" cellspacing="0" cellpadding="4">
				<tr>
                  <td align="center"> <div align="center"><img src="images/branchesToCollapse.jpg" width="300" height="256"></div></td>                  
				  <td align="center"> <div align="center"><img src="images/fragModelScaled.jpg" width="300" height="256"></div></td>
				</tr>
				<tr>
					<td align="center"></td>
					<td align="center"><font face="Trebuchet MS">Fragmentation Model</font></td>
				</tr>
 			</table>
			<p>We can set all the branch lengths to equal 100000 generations from the Tree Menu: <u><font size="-1">Tree 
			&gt; Alter/Transform Branch Lengths... &gt; Assign All Branch Lengths...</font></u> and entering 100000 in 
			the dialog box that appears.  Remember to use <u><font size="-1">Tree &gt; Store Tree</font></u> in order 
			to retain these changes.  Unless you have selected <u><font size="-1">Drawing &gt; Branches Proportional to 
			Lengths</font></u> the tree drawing does not change after you've assigned the branch lengths.  You can 
			toggle the branch lengths and scale from the Drawing Menu (<u><font size="-1">Branches Proportional to 
			Lengths</font></u> and <u><font size="-1">Show Scale</font></u>, respectively).</p>

			<p>For our alternative model, we will test the hypothesis that Populations 1 &amp; 2 and Populations 
			3 &amp; 4 were isolated in two refugia 100000 generations ago, and only recently split 
			(1000 generations ago) from two into four populations.  For this model tree, we manipulate the 
			fragmentation model tree to reflect the alternative model, and store a copy of this tree under another 
			name (using Store Tree As... instead of Store Tree to avoid overwriting the fragmentation model 
			tree; storing this model tree in the same tree block as the fragmentation model tree will make 
			things easier later on).  Using the arrow tool (<img src="../images/arrow.gif">) in the population 
			tree window, we join the branches of populations 1 &amp; 2 and populations 3 &amp; 4 (below, left).  
			To assign branch lengths to individual branches, use the Adjust Branch Length tool 
			(<img src="../images/treeTools/adjustBranchLength.gif">) on each branch, assigning branches 
			1-4 a value of 1000 generations (recent split) and branches 5 &amp; 6 a value of 99000 (so the age 
			of the split is 100000 generations ago).  Because the branch lengths of branches 1-4 are 
			relatively short, it may be difficult to visualize them when branches are drawn proportional to 
			lengths (below, right), so turning off Branches Proportional to Length may ease manipulation.</p>
			
				<table width="100%" border="0" cellspacing="0" cellpadding="4">
				<tr>
                  <td align="center"> <div align="center"><img src="images/refugiaModel.jpg" width="300" height="256"></div></td>                  
				  <td align="center"> <div align="center"><img src="images/refugiaModelScaled.jpg" width="300" height="256"></div></td>
				</tr>
				<tr>
					<td align="center"></td>
					<td align="center"><font face="Trebuchet MS">Refugia Model</font></td>
				</tr>

 			</table>
			<p>We will use the two model trees, fragmentation and refugia, to generate a simulated distribution 
			of the test statistic.</p>
			</td>
			</tr>
			</table>
			<p><strong>Simulating distributions of test statistic</strong>
				To simulate a distribution of Slatkin &amp; Maddison's s, bring the tree window 
				of the population tree corresponding to the model you wish to test to the front.  
				Select <u><font size="-1">Analysis &gt; New Bar &amp; Line Chart for &gt; Trees</font></u>.  
				In the &quot;Select Taxa&quot; dialog that opens, select the block of taxa corresponding to 
				the gene sequences.  Choose &quot;Simulated Trees&quot; as the source of trees, and &quot;Coalescence 
				Contained within Current Tree&quot; as the Tree Simulator (in older versions of Mesquite, you may 
				have to check the &quot;Show Secondary Choices&quot; box for this tree simulator to be an option).
				Set the effective population size when prompted, and choose &quot;s of Slatkin &amp; Maddison&quot; 
				as the value to calculate for trees (s of Slatkin &amp; Maddison may be a Secondary Choice, so 
				you'll have to check the appropriate box for it to appear as an option).  You will be 
				prompted to enter the number of trees for the chart, and asked if the current window is 
				appropriate for simulations (you should check to be sure the tree window corresponding to the 
				model you wish to test is the one Mesquite is querying you about).  If you have multiple 
				associations in your file, you will be prompted to choose the association for generating 
				gene trees first, then you will be prompted <i>again</i> to choose the association for 
				calculating <i>s</i>.  These will often be the same, but certain situations may arise 
				when the association on which the model is based is not the same as the association 
				for which the statistic is calculated.
				</p>
				<p>Mesquite uses a stepwise process to generate the distribution of the test 
				statistic.  It repeats the following steps N times, where N is the number of trees you 
				asked Mesquite to use for calculations:</p>
				<ul>
					<li>Simulate a gene tree within population gene tree</li>
					<li>Calculate the value of <i>s</i> for that gene tree and given association</li>
					<li>Record the value of <i>s</i></li>
					<li>Discard gene tree</li>
				</ul>
				<p>After Mesquite has recorded the simulated values, a Chart Window will show a histogram 
				of the simulated distribution.  By clicking on the &quot;Text&quot; tab, you can see the 
				numbers used to generate the frequency distribution for the test statistic.  These numbers 
				can be copied &amp; pasted into a spreadsheet program to generate graphs outside of Mesquite.  
				Additionally, in the &quot;Graphics&quot; view, you can ask Mesquite to draw lines on 
				the distribution corresponding to 95% confidence interval.  In the Chart Window, 
				select <u><font size="-1">Chart &gt; Analysis &gt; Percentiles...</font></u>.  From here, 
				you can choose upper or lower bounds, as well as the size of the percentiles (e.g. for the 
				90% confidence interval, enter 0.1 for the Percentile Boundary).</p>
				<p>The chart window displaying the distribution of <i>s</i> is dependent on the Tree 
				Window showing the population tree on which the gene trees were simulated.  By default, 
				the Chart Window is set to re-calculate <i>s</i> if any changes are made to the Tree 
				Window.  Thus, if you make changes to the Tree Window (re-arrange branches, change 
				branch lengths, or scroll between trees), the chart will re-simulate gene trees and 
				perform necessary calculations to reflect the distibution of <i>s</i> corresponding 
				to the tree shown in the Tree Window.  The auto-recalculate option can be toggled on/off 
				from the Chart menu, if desired.  However, if you are testing more than one model of 
				population structure, it is easiest to:</p>
				<ul>
					<li>Generate a distribution for the first model to be tested</li>
					<li>Record the distribution (copy &amp; paste from the &quot;Text&quot; tab 
					into a spreadsheet program)</li>
					<li>In the Tree Window, scroll to the next model to be tested; the distribution 
					will be automatically recalculated, based on the new model</li>
					<li>Repeat for each model being tested, recording the distribution of <i>s</i> for each model</li>
				</ul>
				<p>If the observed value of <i>s</i> falls outside of the 95% confidence interval for a 
				particular model, that model, and the associated parameter values (branch lengths, population 
				size, etc.) are not supported by the data.</p>
			<table width="100%" border="0" cellspacing="0" cellpadding="5">
				<tr>
					<td bgcolor="#99FF99">
						<p>We begin by simulating a distribution of <i>s</i> for the fragmentation model.  
						From the Tree Window showing the fragmentation model population tree, we select 
						<u><font size="-1">Analysis &gt; New Bar &amp; Line Chart for &gt; Trees</font></u>, 
						choosing, as prompted, Genes Taxa Block (taxa to calculate value), Simulated Trees 
						(source of trees), Coalescence Contained within Current Tree (tree simulator), 
						10000 (effective population size), s of Slatkin &amp; Maddison (Value to calculate), 
						1000 (trees for the chart), and check to be certain that Mesquite is using the 
						fragmentation model tree.  The chart window opens, showing the distribution of 
						simulated values of <i>s</i>.</p>  
						
					<center><img src="images/fragModelSim.jpg"></center>

						<p>By clicking on the &quot;Text&quot; tab, we can see the details of the simulations:</p>

					<center><img src="images/fragModelText.jpg"></center>

						<p>Because our observed valus of <i>s</i> = 9 was not within the 95% confidence interval 
						of the simulated distribution, we reject the fragmentation model.</p>
						
						<p>To test the refugia model, we can take advantage of the Chart Window's dependancy
						on the Tree Window.  Leaving the Chart Window open, we can scroll to the refugia model
						tree in the Tree Window.</p>

					<center><img src="images/fragModelWindow.jpg"></center>
						<br>
					<center><img src="images/refugiaModelWindow.jpg"></center>	
						
						<p>The Chart Window will be updated with new simulations, based on the refugia model 
						tree (if it does not, you may need to turn on &quot;Auto-recalculate&quot; from the 
						Chart menu in the Chart Window).  By selecting <u><font size="-1">Chart &gt; Analysis &gt; 
						Percentiles...</font></u>, setting the Percentile boundary to 0.05, and checking the 
						boxes for both upper and lower tails, we can see the 95% confidence interval for this 
						distribution:</p>
					<center><img src="images/refugiaModelSim.jpg"></center>
						<p>Because our observed value <i>s</i> = 9 falls within the 95% confidence interval, 
						we do not reject the two refugia model.  By clicking on the &quot;Text&quot; tab, the full
						details of the distribution can be seen:</p>
					<center><img src="images/refugiaModelText.jpg"></center>
						<p>From these results, we reject the fragmentation model in favor of the two refugia model.  
						Further tests of deeper and shallower divergence times can provide confidence interval for 
						this model, for given parameter values.</p>
					</td>
				</tr>
			</table>
			<p>In closing, it is important to consider parameter values (N<font size="-1">e</font>, divergence times, etc.) 
			and the explanatory power of the tests.  In the example above, if we had used an effective population size 
			100 times larger (N<font size="-1">e</font> = 1,000,000), the fragmentation model is <i>not</i> rejected 
			(the observed value of <i>s</i> = 9 falls within the 95% confidence interval of the simulated distribution 
			of <i>s</i>).  We encourage careful consideration of reasonable parameter values in these approaches.  
			Rather than relying on one or a few point estimates of parameter values, it may be most informative to 
			explore parameter space, and define that parameter space that would best explain the given pattern of 
			genetic variation.</p>

						
			  <!-- #EndEditable --></font></td>          </tr>        </table>        <table border="0" cellspacing="0" cellpadding="5" width="100%">          <tr>             <td align="left" valign="top">               <hr>              <p align="center"><font face="Trebuchet MS"><span class="smallplain"><a href="http://mesquiteproject.org"><font size="2">Mesquite              Home Page</font></a><font size="2"> | <a href="../manual.html">Mesquite              Manual</a></font></span></font></p>              <p><font face="Trebuchet MS"><span class="smallplain">Copyright                 &copy; 2002-2007 by <a href="http://salticidae.org/wpm/home.html">Wayne                 P. Maddison</a> and <a href="http://david.bembidion.org">David                 R. Maddison</a>.<br>&nbsp;All rights reserved.</span></font></p></td>          </tr>        </table>      </td>    </tr>  </table></div><font face="Trebuchet MS"> </font></body><!-- #EndTemplate --></html>