/* Mesquite module ~~ Copyright 1997-2001 W. & D. Maddison*/package mesquite.geiger.NodeDistanceFromRoot;/*~~  */import java.util.*;import java.awt.*;import mesquite.lib.*;import mesquite.lib.duties.*;/** ======================================================================== */public class NodeDistanceFromRoot extends NumbersForNodes {	/*.................................................................................................................*/	public boolean startJob(String arguments, Object condition, CommandRecord commandRec, boolean hiredByName) {		return true;   	} 		/*.................................................................................................................*/   	/** Called to provoke any necessary initialization.  This helps prevent the module's intialization queries to the user from   	happening at inopportune times (e.g., while a long chart calculation is in mid-progress)*/   	public void initialize(Tree tree, CommandRecord commandRec){   	}	/*.................................................................................................................*/	public  void calculateNumbers(Tree tree, NumberArray result, MesquiteString resultString, CommandRecord commandRec) {		if (result==null)			return;		result.deassignArray();		visitNodes(tree, tree.getRoot(), result, 0.0);		if (resultString!= null){			if (tree.allLengthsAssigned(false))				resultString.setValue("Distances from root.");			else				resultString.setValue("Distances from root (unassigned branch lengths exist; treated as 1.0.");		}	}  	 private void visitNodes(Tree tree,int node, NumberArray result, double distanceFromRoot){		if (tree.nodeIsInternal(node)){			for (int daughter = tree.firstDaughterOfNode(node); tree.nodeExists(daughter); daughter = tree.nextSisterOfNode(daughter))				visitNodes(tree, daughter, result, distanceFromRoot + tree.getBranchLength(daughter, 1.0));		}		result.setValue(node, distanceFromRoot);		  	 }	/*.................................................................................................................*/    	 public String getName() {		return "Distance from Root";   	 }	/*.................................................................................................................*/  	 public String getVersion() {		return null;   	 }	/*.................................................................................................................*/ 	/** returns an explanation of what the module does.*/ 	public String getExplanation() { 		return "Calculates the distance of a node from the root.";   	 }   	 }